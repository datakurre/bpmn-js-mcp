<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" id="Definitions_1" targetNamespace="http://bpmn.io/schema/bpmn">
  <bpmn:collaboration id="Collab1">
    <bpmn:participant id="Pool_Main" name="Order Process" processRef="Process_Lanes" />
  </bpmn:collaboration>
  <bpmn:process id="Process_Lanes" name="Pool with Lanes" isExecutable="true" camunda:historyTimeToLive="P180D">
    <bpmn:laneSet id="LaneSet_1">
      <bpmn:lane id="Lane_Sales" name="Sales" />
      <bpmn:lane id="Lane_Warehouse" name="Warehouse" />
      <bpmn:lane id="Lane_Finance" name="Finance" />
    </bpmn:laneSet>
    <bpmn:startEvent id="Start" name="Order Received">
      <bpmn:outgoing>Flow1</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:userTask id="ReceiveOrder" name="Receive Order" camunda:candidateGroups="sales">
      <bpmn:incoming>Flow1</bpmn:incoming>
      <bpmn:outgoing>Flow2</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:parallelGateway id="GW_Split">
      <bpmn:incoming>Flow2</bpmn:incoming>
      <bpmn:outgoing>Flow_WH</bpmn:outgoing>
      <bpmn:outgoing>Flow_FIN</bpmn:outgoing>
    </bpmn:parallelGateway>
    <bpmn:userTask id="PickItems" name="Pick Items" camunda:candidateGroups="warehouse">
      <bpmn:incoming>Flow_WH</bpmn:incoming>
      <bpmn:outgoing>FlowWH2</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:manualTask id="PackItems" name="Pack Items">
      <bpmn:incoming>FlowWH2</bpmn:incoming>
      <bpmn:outgoing>FlowWH3</bpmn:outgoing>
    </bpmn:manualTask>
    <bpmn:serviceTask id="ProcessPayment" name="Process Payment" camunda:type="external" camunda:topic="payment-process">
      <bpmn:incoming>Flow_FIN</bpmn:incoming>
      <bpmn:outgoing>FlowFIN2</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:parallelGateway id="GW_Join">
      <bpmn:incoming>FlowWH3</bpmn:incoming>
      <bpmn:incoming>FlowFIN2</bpmn:incoming>
      <bpmn:outgoing>Flow3</bpmn:outgoing>
    </bpmn:parallelGateway>
    <bpmn:sendTask id="SendInvoice" name="Send Invoice" camunda:delegateExpression="${invoiceSender}">
      <bpmn:incoming>Flow3</bpmn:incoming>
      <bpmn:outgoing>Flow4</bpmn:outgoing>
    </bpmn:sendTask>
    <bpmn:endEvent id="End" name="Order Fulfilled">
      <bpmn:incoming>Flow4</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow1" sourceRef="Start" targetRef="ReceiveOrder" />
    <bpmn:sequenceFlow id="Flow2" sourceRef="ReceiveOrder" targetRef="GW_Split" />
    <bpmn:sequenceFlow id="Flow_WH" sourceRef="GW_Split" targetRef="PickItems" />
    <bpmn:sequenceFlow id="Flow_FIN" sourceRef="GW_Split" targetRef="ProcessPayment" />
    <bpmn:sequenceFlow id="FlowWH2" sourceRef="PickItems" targetRef="PackItems" />
    <bpmn:sequenceFlow id="FlowWH3" sourceRef="PackItems" targetRef="GW_Join" />
    <bpmn:sequenceFlow id="FlowFIN2" sourceRef="ProcessPayment" targetRef="GW_Join" />
    <bpmn:sequenceFlow id="Flow3" sourceRef="GW_Join" targetRef="SendInvoice" />
    <bpmn:sequenceFlow id="Flow4" sourceRef="SendInvoice" targetRef="End" />
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_Process_Lanes">
    <bpmndi:BPMNPlane id="BPMNPlane_Process_Lanes" bpmnElement="Process_Lanes">
      <bpmndi:BPMNShape id="Start_di" bpmnElement="Start">
        <dc:Bounds x="192" y="122" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="171" y="158" width="78" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ReceiveOrder_di" bpmnElement="ReceiveOrder">
        <dc:Bounds x="288" y="100" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="GW_Split_di" bpmnElement="GW_Split">
        <dc:Bounds x="453" y="115" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="GW_Join_di" bpmnElement="GW_Join">
        <dc:Bounds x="893" y="115" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="SendInvoice_di" bpmnElement="SendInvoice">
        <dc:Bounds x="1008" y="100" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="End_di" bpmnElement="End">
        <dc:Bounds x="1168" y="122" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1151" y="158" width="70" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="PickItems_di" bpmnElement="PickItems">
        <dc:Bounds x="568" y="100" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="PackItems_di" bpmnElement="PackItems">
        <dc:Bounds x="728" y="100" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ProcessPayment_di" bpmnElement="ProcessPayment">
        <dc:Bounds x="728" y="210" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow1_di" bpmnElement="Flow1">
        <di:waypoint x="228" y="140" />
        <di:waypoint x="288" y="140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow2_di" bpmnElement="Flow2">
        <di:waypoint x="388" y="140" />
        <di:waypoint x="453" y="140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_WH_di" bpmnElement="Flow_WH">
        <di:waypoint x="503" y="140" />
        <di:waypoint x="568" y="140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_FIN_di" bpmnElement="Flow_FIN">
        <di:waypoint x="478" y="165" />
        <di:waypoint x="478" y="250" />
        <di:waypoint x="728" y="250" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="FlowWH2_di" bpmnElement="FlowWH2">
        <di:waypoint x="668" y="140" />
        <di:waypoint x="728" y="140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="FlowWH3_di" bpmnElement="FlowWH3">
        <di:waypoint x="828" y="140" />
        <di:waypoint x="893" y="140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="FlowFIN2_di" bpmnElement="FlowFIN2">
        <di:waypoint x="828" y="250" />
        <di:waypoint x="918" y="250" />
        <di:waypoint x="918" y="165" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow3_di" bpmnElement="Flow3">
        <di:waypoint x="943" y="140" />
        <di:waypoint x="1008" y="140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow4_di" bpmnElement="Flow4">
        <di:waypoint x="1108" y="140" />
        <di:waypoint x="1168" y="140" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
