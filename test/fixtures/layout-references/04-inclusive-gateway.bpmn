<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" id="Definitions_1" targetNamespace="http://bpmn.io/schema/bpmn">
  <bpmn:process id="Process_InclusiveGateway" name="Inclusive Gateway - Notification Channels" isExecutable="true" camunda:historyTimeToLive="P180D">
    <bpmn:startEvent id="Start" name="Alert Triggered">
      <bpmn:outgoing>Flow1</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:serviceTask id="ClassifyAlert" name="Classify Alert" camunda:type="external" camunda:topic="alert-classify">
      <bpmn:incoming>Flow1</bpmn:incoming>
      <bpmn:outgoing>Flow2</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:inclusiveGateway id="OR_Split" name="Notify via?" default="Flow_Email">
      <bpmn:incoming>Flow2</bpmn:incoming>
      <bpmn:outgoing>Flow_Email</bpmn:outgoing>
      <bpmn:outgoing>Flow_SMS</bpmn:outgoing>
      <bpmn:outgoing>Flow_Push</bpmn:outgoing>
    </bpmn:inclusiveGateway>
    <bpmn:sendTask id="SendEmail" name="Send Email" camunda:delegateExpression="${emailService}">
      <bpmn:incoming>Flow_Email</bpmn:incoming>
      <bpmn:outgoing>FlowE2</bpmn:outgoing>
    </bpmn:sendTask>
    <bpmn:sendTask id="SendSMS" name="Send SMS" camunda:delegateExpression="${smsService}">
      <bpmn:incoming>Flow_SMS</bpmn:incoming>
      <bpmn:outgoing>FlowS2</bpmn:outgoing>
    </bpmn:sendTask>
    <bpmn:sendTask id="SendPush" name="Send Push" camunda:delegateExpression="${pushService}">
      <bpmn:incoming>Flow_Push</bpmn:incoming>
      <bpmn:outgoing>FlowP2</bpmn:outgoing>
    </bpmn:sendTask>
    <bpmn:inclusiveGateway id="OR_Join">
      <bpmn:incoming>FlowE2</bpmn:incoming>
      <bpmn:incoming>FlowS2</bpmn:incoming>
      <bpmn:incoming>FlowP2</bpmn:incoming>
      <bpmn:outgoing>Flow3</bpmn:outgoing>
    </bpmn:inclusiveGateway>
    <bpmn:serviceTask id="LogNotification" name="Log Notification" camunda:class="com.example.NotificationLogger">
      <bpmn:incoming>Flow3</bpmn:incoming>
      <bpmn:outgoing>Flow4</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:endEvent id="End" name="Alert Handled">
      <bpmn:incoming>Flow4</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow1" sourceRef="Start" targetRef="ClassifyAlert" />
    <bpmn:sequenceFlow id="Flow2" sourceRef="ClassifyAlert" targetRef="OR_Split" />
    <bpmn:sequenceFlow id="Flow_Email" name="Email" sourceRef="OR_Split" targetRef="SendEmail" />
    <bpmn:sequenceFlow id="Flow_SMS" name="SMS" sourceRef="OR_Split" targetRef="SendSMS">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${severity == 'high'}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_Push" name="Push" sourceRef="OR_Split" targetRef="SendPush">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${severity == 'critical'}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="FlowE2" sourceRef="SendEmail" targetRef="OR_Join" />
    <bpmn:sequenceFlow id="FlowS2" sourceRef="SendSMS" targetRef="OR_Join" />
    <bpmn:sequenceFlow id="FlowP2" sourceRef="SendPush" targetRef="OR_Join" />
    <bpmn:sequenceFlow id="Flow3" sourceRef="OR_Join" targetRef="LogNotification" />
    <bpmn:sequenceFlow id="Flow4" sourceRef="LogNotification" targetRef="End" />
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_Process_InclusiveGateway">
    <bpmndi:BPMNPlane id="BPMNPlane_Process_InclusiveGateway" bpmnElement="Process_InclusiveGateway">
      <bpmndi:BPMNShape id="Start_di" bpmnElement="Start">
        <dc:Bounds x="192" y="157" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="174" y="193" width="73" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ClassifyAlert_di" bpmnElement="ClassifyAlert">
        <dc:Bounds x="288" y="135" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="OR_Split_di" bpmnElement="OR_Split">
        <dc:Bounds x="453" y="150" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="452" y="210" width="52" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="SendEmail_di" bpmnElement="SendEmail">
        <dc:Bounds x="568" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="SendSMS_di" bpmnElement="SendSMS">
        <dc:Bounds x="728" y="135" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="SendPush_di" bpmnElement="SendPush">
        <dc:Bounds x="568" y="190" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="OR_Join_di" bpmnElement="OR_Join">
        <dc:Bounds x="893" y="150" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="LogNotification_di" bpmnElement="LogNotification">
        <dc:Bounds x="1008" y="135" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="End_di" bpmnElement="End">
        <dc:Bounds x="1168" y="157" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1153" y="193" width="67" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow1_di" bpmnElement="Flow1">
        <di:waypoint x="228" y="175" />
        <di:waypoint x="288" y="175" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow2_di" bpmnElement="Flow2">
        <di:waypoint x="388" y="175" />
        <di:waypoint x="453" y="175" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_Email_di" bpmnElement="Flow_Email">
        <di:waypoint x="478" y="150" />
        <di:waypoint x="478" y="120" />
        <di:waypoint x="568" y="120" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="479" y="128" width="28" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_SMS_di" bpmnElement="Flow_SMS">
        <di:waypoint x="503" y="175" />
        <di:waypoint x="728" y="175" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="601" y="208" width="24" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_Push_di" bpmnElement="Flow_Push">
        <di:waypoint x="478" y="200" />
        <di:waypoint x="478" y="230" />
        <di:waypoint x="568" y="230" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="450" y="208" width="26" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="FlowE2_di" bpmnElement="FlowE2">
        <di:waypoint x="668" y="120" />
        <di:waypoint x="918" y="120" />
        <di:waypoint x="918" y="150" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="FlowS2_di" bpmnElement="FlowS2">
        <di:waypoint x="828" y="175" />
        <di:waypoint x="893" y="175" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="FlowP2_di" bpmnElement="FlowP2">
        <di:waypoint x="668" y="230" />
        <di:waypoint x="918" y="230" />
        <di:waypoint x="918" y="200" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow3_di" bpmnElement="Flow3">
        <di:waypoint x="943" y="175" />
        <di:waypoint x="1008" y="175" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow4_di" bpmnElement="Flow4">
        <di:waypoint x="1108" y="175" />
        <di:waypoint x="1168" y="175" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
